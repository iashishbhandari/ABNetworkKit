## Usage

### Making a Request

A sample Request enumeration conforming the `ABRequestProtocol`

```swift

import ABNetworkKit

enum SampleRequest: ABRequestProtocol {

    case fetchSampleData

    var actionType: ABRequestAction {
        return .data
    }

    var headers: [String : String]? {
        return ["content-type" : "application/json"]
    }

    var method: ABHTTPMethod {
        return .get
    }

    var parameters: ABRequestParams {
        return .url(nil)
    }

    var path: String {
        return "/location"
    }

    var responseType: ABResponseType {
        return .json
    }
}

```

### Making a Operation

A sample Operation enumeration confirming the `ABOperationProtocol`

```swift

class SampleOperation: ABOperationProtocol {

    var sessionTask: URLSessionTask?

    typealias Output = ABNetworkResponse

    var request: ABRequestProtocol

    init(_ request: ABRequestProtocol) {
        self.request = request
    }

    func cancel() {
        sessionTask?.cancel()
    }

    func execute(in dispatcher: ABDispatcherProtocol, 
                    _ completion: @escaping (ABNetworkResponse) -> Void) {
        
        do {
            sessionTask = try dispatcher.execute(request: request, 
                                                    completion: { (response) in
                completion(response)
            })

        } catch (let exception) {
            completion(ABNetworkResponse.error(exception, nil))
        }
    }
}

```

### Response Handling

The `ABNetworkResponse` handler for converting HTTP Response to corresponding `ResponseType`

```swift

enum ABNetworkResponse {

    case error(_: Error?, _: HTTPURLResponse?)
    
    case file(location: URL?, _: HTTPURLResponse?)

    case json(_: Any?, _: HTTPURLResponse?)
}

```


### Session Delegate

By default, an ABNetworkKit `ABNetworkServices` instance creates a SessionDelegate object to handle all the various types of delegate callbacks that are generated by the underlying URLSession.

The following is a short example of how to use the `taskWillPerformHTTPRedirection` to avoid following redirects to any apple.com domains.

```swift

let services = ABNetworkKit.ABNetworkServices(configuration:.default, 
                                                delegate: OperationQueue())

services.taskWillPerformHTTPRedirection = { session, task, response, request in
    var finalRequest = request
    if let originalRequest = task.originalRequest,
        let urlString = originalRequest.url?.urlString,
        urlString.contains("apple.com") {
            finalRequest = originalRequest
    }
    return finalRequest
}

```

### Authentication

Authentication is handled on the system framework level by [`URLAuthenticationChallenge`](https://developer.apple.com/reference/foundation/urlauthenticationchallenge).

### NetworkSecurityPolicy

The `evaluateServerTrust` method on the `NetworkSecurityPolicy` will automatically provide a `URLCredential` to a `URLAuthenticationChallenge` when appropriate based on a user defined `ABSSLPinningMode` policy:

```swift

internal enum ABSSLPinningMode {

    case certificate

    case none
}

```

> It is important to note that when using a `URLCredential` for authentication, the underlying `URLSession` will actually end up making two requests if a challenge is issued by the server. The first request will not include the credential which "may" trigger a challenge from the server. The challenge is then received by ABNetworkKit, the credential is appended and the request is retried by the underlying `URLSession`.


